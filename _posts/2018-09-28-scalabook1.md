---
layout: post
title: "[스파크2프로그래밍]1장-Spark / RDD"
author: "Myeongseon"
category: "bigdata"
---
#스파크 2 프로그래밍

### 1.1.4 스파크
스파크는 하둡 기반의 맵리듀스 작업이 가진 단점을 보안하기 위한것<br>
메모리를 이용한 데이터 저장 방식을 제공함으로써 머신러닝 등 반복적인 데이터가 필요한 분야에서 높은 성능을 보여준다.

* * *

### 1.1.5 RDD 소개와 연산 ((RDD에 대해 이해하자))
##### RDD : Resilient Distributed Dataset==

프로그램을 작성할 때 모델링은 중요한 역할을 한다.
```
모델링 ? <br>
적용되는 분야에 따라 의미가 달라질 수 있지만 프로그램에서 모델링이란 현실 세계에 존재하는 사물이나 개념을 프로그래밍 언어로 설명하는 과정
```
스파크에서 제공하는 RDD 역시 일종의 분산 데이터에 대한 모델 이라고 할 수 있다.
```
RDD 란 스파크가 사용하는 핵심 데이터 모델로서 다수의 서버에 걸쳐 분산 방식으로<br>
저장된 데이터 요소들의 집합을 의미하며
병럴처리가 가능하고 장애가 발생할 경우에도 스스로 복구 될 수 있는 내성을 갖고 있다.
```
즉 RDD란 스파크에서 정의한 분산 데이터 모델::<br>
내부에는 단위 데이터를 포함, 저장할 때는 여러 서버에 나누어 저장, 처리할 때는 각 서버에 저장된 데이터를 동시에 병렬로 처리할 수 있다.<br> 또한 처리 과정에서 서버 또는 데이터에 문제가 발생하더라도 스스로 에러를 복구 할 수 있는 능력을 갖고 있다.

_ _ _
##### RDD-- 분산 데이터의 집합
하나의 RDD에 속한 요소들을 파티션이라고 하며, 파티션은 더 작은 단위로 나눠질 수 있으며 스파크는 작업을 수행할 때 파티션단위로 나눠서 병렬로 처리를 수행합니다.<br>
이렇게 만들어진 파티션은 작업이 진행되는 과정에서 재구성되거나, 네트워크를 통해 다른 서버로 이동하는 셔플링이 발생 할 수 있습니다.<br>
(파티션의 수는 곧 데이터 처리에 참여하는 병렬 프로세스의 수 입니다. <br>즉 하나의 데이터를 잘게 쪼개어 여러 개의 파티션을 만들면 여러 프로세스에서 동시에 작업을 처리해서 속도가 증가할 수 있지만 정도가 지나치면 전체 성능을 떨어뜨리는 요인이 됩니다.)

RDD는 포함된 데이터를 저장하고 있는 곳이 아닌 생성했던 작업내용을 기억하는 것으로 복구 과정에서 RDD를 생성했던 작업만 다시 수행한다.<br>
이렇게 복구를 수행하기 위해서는 생성된 RDD가 바뀌지 않아야 한다는 조건이 필요하다.<br>
=> 스파크는 RDD가 생성되어 변경되는 모든 과정을 일일이 기억하는 대신 RDD를 한번 생성되면 변경되지 않는 읽기 전용 모델로 만든 후 RDD 생성과 관련된 내용만 기억하고 있다가 에러 발생시 이전에 RDD를 만들 때 수행했던 작업을 똑같이 실행해 데이터를 복구한다.

_ _ _


##### ****RDD의 특성****
1. RDD는 스파크의 데이터 모델이자 프로그래밍 API이다.
2. RDD 는 map, flatmap 과 같은 메서드를 이용해 내부에 포함된 모든 데이터에 특정 연산을 적용할 수 있습니다. 숫자 데이터만 갖고 있는 RDD 가 있다면 map이라는 매서드를 이용해 모든 데이터 요소에 10을 곱하거나 1을 더하는 변경을 할 수 있다.
3. 이렇게 변경시 RDD의 요소로 지정되어 있던 데이터 값이 바뀌는데 기존의 RDD가 바뀌는 것이 아닌 새로운 RDD가 생성된다. => 이전 RDD, 새로운 RDD로 RDD가 총 2개
4. 스파크는 생성된 RDD에 대해 기존의 RDD에 어떤 종류의 연산을 적용해서 만들어진 것인지 정보를 기억하고 있다.
5. 어느 시점에 장애가 발생하더라도 동일한 방법으로 만든 RDD는 항상 동일한 데이터를 가지고 있음을 보장 받을 수 있다.

_ _ _

#####  RDD의 생성방법
1. List 나 Set같은 기존 프로그램의 메모리에 생성된 데이터를 이용하는 것<br>
특별한 데이터 소스를 준비할 필요없이 RDD의 기능을 즉시 테스트 해 볼 수있다.<br>
`[스칼라] rdd = sc.parallelize(List("a", "b", "c", "d"))`<br>
`[파이썬] rdd = sc.parallelize(["a", "b", "c", "d"])`<br>

2. 로컬 파일시스템이나 하둡의 HDFS 같은 외부 저장소에 저장된 데이터를 읽어서 생성하는 방법<br>
스파크는 다양한 유형의 데이터 소스로부터 데이터를 읽고 RDD를 생성할 수 있는 유용한 함수를 제공한다.<br>
`[스칼라] var rdd = sc.textFile("<path_to_file>")`<br>
`[파이썬] rdd = sc.textFile("<path_to_file>")`<br>

3. 기존에 생성되어 있는 RDD로부터 또다른 RDD를 생성하는 방법<br>
`[스칼라] var rdd1 = rdd.map(_.toUpperCase())`<br>
`[파이썬] rdd1 = rdd.map(lambda s: s.upper())`<br>

#### - - -
RDD를 생성하면 RDD가 제공하는 다양한 연산을 이용해 데이터를 처리한다.<br>
이때 RDD에서 제공하는 연산은 "transformation", "action" 두종류로 나눌 수 있다.<br>
- 트랜스포메이션 (transformation) 연산이란?<br>
RDD에 변형을 가해 새로운 RDD를 생성하는 연산으로, 기존의 RDD는 바뀌지 않은 채 변형된 값을 가진 새로운 RDD가 생성됩니다.<br>
ex) rdd로 부터 rdd1 을 생성할 때 사용된 map 연산은 rdd에 있는 요소 각각에 소문자를 대문자로 바꾸는 함수를 적용해 그 결과값으로 구성된 새로운 RDD를 만들어 냅니다.<br>
트랜스포메이션 연산이 가진 특징 : 연산이 호출되는 시점에 바로 실행되는 것이 아닌 RDD에 대한 생성 계보만 만들면서 쌓여있다가 "액션"에 대한 연산이 호출될 때 한꺼번에 실행됨<br>

- 액션 (action) 연산이란?<br>
그 여산의 결과로 RDD가 아닌 다른 값을 반환하거나 아예 반환하지 않는 연산을 의미한다.<br>
ex) RDD의 크기를 계산해서 Long 값을 반환한다거나 RDD를 화면에 출력 또는 외부 저장소에 저장하는 등의 동작<br>
